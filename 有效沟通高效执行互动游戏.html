<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æœ‰æ•ˆæ²Ÿé€š é«˜æ•ˆæ‰§è¡Œ - äº’åŠ¨æ¸¸æˆ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .pulse-animation {
            animation: pulse 2s infinite;
        }
        .float-animation {
            animation: float 3s ease-in-out infinite;
        }
        .fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }
        .message-bubble {
            transition: all 0.3s ease;
        }
        .message-bubble:hover {
            transform: scale(1.1);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        .progress-bar {
            transition: width 0.5s ease;
        }
        .task-item {
            transition: all 0.3s ease;
        }
        .task-item:hover {
            transform: translateX(5px);
        }
        .game-container {
            max-height: 90vh;
            overflow-y: auto;
        }
        @media (min-width: 1024px) {
            .game-container {
                width: 800px;
            }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen flex flex-col items-center justify-center p-4">
    <div class="game-container w-full bg-white rounded-2xl shadow-xl overflow-hidden relative">
        <!-- æ¸¸æˆä¸»ç•Œé¢ -->
        <div id="game-container" class="flex flex-col">
            <!-- é¡¶éƒ¨æ ‡é¢˜åŒºåŸŸ -->
            <div class="bg-gradient-to-r from-blue-600 to-indigo-700 p-4 text-white text-center sticky top-0 z-10">
                <h1 class="text-2xl font-bold float-animation">æœ‰æ•ˆæ²Ÿé€š é«˜æ•ˆæ‰§è¡Œ</h1>
                <p class="text-sm opacity-80">å¾æ³“æ™–ä¸“å±äº’åŠ¨æ¸¸æˆ</p>
            </div>
            
            <!-- æ¸¸æˆå†…å®¹åŒºåŸŸ -->
            <div class="flex-1 p-6 flex flex-col space-y-6">
                <!-- æ¸¸æˆè¯´æ˜ -->
                <div id="intro-screen" class="text-center flex flex-col items-center justify-center min-h-[400px] fade-in">
                    <div class="bg-blue-100 rounded-full p-4 mb-6">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z" />
                        </svg>
                    </div>
                    <h2 class="text-xl font-semibold text-gray-800 mb-2">æ²Ÿé€šæ•ˆç‡ä¸æ‰§è¡Œæ•ˆæœçš„å…³ç³»</h2>
                    <p class="text-gray-600 mb-6 max-w-md">åœ¨è¿™ä¸ªæ¸¸æˆä¸­ï¼Œæ‚¨å°†ä½“éªŒä¸åŒæ²Ÿé€šæ–¹å¼å¦‚ä½•å½±å“ä»»åŠ¡æ‰§è¡Œæ•ˆæœã€‚é€šè¿‡è°ƒæ•´æ²Ÿé€šå‚æ•°ï¼Œè§‚å¯Ÿæœ€ç»ˆæ‰§è¡Œç»“æœçš„å˜åŒ–ã€‚</p>
                    <button id="start-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-6 rounded-full transition-all transform hover:scale-105 shadow-lg pulse-animation">
                        å¼€å§‹æ¸¸æˆ
                    </button>
                </div>
                
                <!-- æ¸¸æˆä¸»ç•Œé¢ -->
                <div id="game-screen" class="hidden flex flex-col space-y-6">
                    <!-- æ²Ÿé€šå‚æ•°è®¾ç½® -->
                    <div class="bg-indigo-50 rounded-lg p-4">
                        <h3 class="font-medium text-indigo-800 mb-2">æ²Ÿé€šå‚æ•°è®¾ç½®</h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-2">
                            <div>
                                <label class="block text-sm text-gray-600 mb-1">æ¸…æ™°åº¦ <span id="clarity-value" class="font-medium">50%</span></label>
                                <input type="range" id="clarity" min="0" max="100" value="50" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                            </div>
                            <div>
                                <label class="block text-sm text-gray-600 mb-1">åŠæ—¶æ€§ <span id="timeliness-value" class="font-medium">50%</span></label>
                                <input type="range" id="timeliness" min="0" max="100" value="50" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                            </div>
                            <div>
                                <label class="block text-sm text-gray-600 mb-1">åé¦ˆé¢‘ç‡ <span id="feedback-value" class="font-medium">50%</span></label>
                                <input type="range" id="feedback" min="0" max="100" value="50" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                            </div>
                        </div>
                        <button id="simulate-btn" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-medium py-2 px-4 rounded-full transition-all transform hover:scale-[1.02] shadow">
                            æ¨¡æ‹Ÿæ‰§è¡Œ
                        </button>
                    </div>
                    
                    <!-- æ²Ÿé€šè¿‡ç¨‹å¯è§†åŒ– -->
                    <div class="bg-white rounded-lg border border-gray-200 p-4">
                        <h3 class="font-medium text-gray-800 mb-4">æ²Ÿé€šè¿‡ç¨‹å¯è§†åŒ–</h3>
                        <div class="flex items-center justify-center relative">
                            <div class="absolute inset-0 flex items-center justify-center">
                                <div class="h-1 bg-gray-200 w-full"></div>
                            </div>
                            
                            <div id="communication-flow" class="relative w-full flex justify-between z-10">
                                <!-- æ²Ÿé€šèŠ‚ç‚¹å°†é€šè¿‡JSåŠ¨æ€æ·»åŠ  -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- æ‰§è¡Œç»“æœå±•ç¤º -->
                    <div id="result-section" class="hidden bg-white rounded-lg border border-gray-200 p-4">
                        <h3 class="font-medium text-gray-800 mb-3">æ‰§è¡Œç»“æœåˆ†æ</h3>
                        <div class="mb-3">
                            <div class="flex justify-between text-sm text-gray-600 mb-1">
                                <span>æ‰§è¡Œæ•ˆç‡</span>
                                <span id="efficiency-score">0%</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2.5">
                                <div id="efficiency-bar" class="bg-green-500 h-2.5 rounded-full progress-bar" style="width: 0%"></div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <div class="flex justify-between text-sm text-gray-600 mb-1">
                                <span>ä»»åŠ¡å®Œæˆåº¦</span>
                                <span id="completion-score">0%</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2.5">
                                <div id="completion-bar" class="bg-blue-500 h-2.5 rounded-full progress-bar" style="width: 0%"></div>
                            </div>
                        </div>
                        <div class="text-sm text-gray-600">
                            <p id="result-feedback" class="italic">è°ƒæ•´æ²Ÿé€šå‚æ•°å¹¶ç‚¹å‡»"æ¨¡æ‹Ÿæ‰§è¡Œ"æŸ¥çœ‹ä¸åŒæ•ˆæœ</p>
                        </div>
                    </div>
                </div>
                
                <!-- æ¸¸æˆç»“æŸç•Œé¢ -->
                <div id="end-screen" class="hidden text-center flex flex-col items-center justify-center min-h-[400px]">
                    <div class="bg-green-100 rounded-full p-4 mb-6">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                    </div>
                    <h2 class="text-xl font-semibold text-gray-800 mb-2">æ¸¸æˆå®Œæˆ!</h2>
                    <p class="text-gray-600 mb-4 max-w-md">æ‚¨å·²ç»ä½“éªŒäº†ä¸åŒæ²Ÿé€šæ–¹å¼å¯¹æ‰§è¡Œæ•ˆæœçš„å½±å“ã€‚è®°ä½:æ¸…æ™°çš„æ²Ÿé€šå¸¦æ¥é«˜æ•ˆçš„æ‰§è¡Œ!</p>
                    <div class="bg-blue-50 rounded-lg p-3 mb-6 w-full">
                        <p class="text-blue-800 font-medium">å¾æ³“æ™–çš„å…³é”®æ”¶è·:</p>
                        <ul class="text-left text-sm text-gray-700 mt-2 space-y-1">
                            <li class="flex items-start">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-blue-500 mt-0.5 mr-1.5 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                                </svg>
                                <span>æé«˜æ²Ÿé€šæ¸…æ™°åº¦å¯å‡å°‘è¯¯è§£</span>
                            </li>
                            <li class="flex items-start">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-blue-500 mt-0.5 mr-1.5 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                                </svg>
                                <span>åŠæ—¶åé¦ˆèƒ½æ˜¾è‘—æå‡æ‰§è¡Œæ•ˆç‡</span>
                            </li>
                            <li class="flex items-start">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-blue-500 mt-0.5 mr-1.5 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                                </svg>
                                <span>å¹³è¡¡å„æ²Ÿé€šè¦ç´ å¯è·å¾—æœ€ä½³æ•ˆæœ</span>
                            </li>
                        </ul>
                    </div>
                    <button id="restart-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-6 rounded-full transition-all transform hover:scale-105 shadow-lg">
                        å†ç©ä¸€æ¬¡
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // è·å–DOMå…ƒç´ 
            const startBtn = document.getElementById('start-btn');
            const restartBtn = document.getElementById('restart-btn');
            const simulateBtn = document.getElementById('simulate-btn');
            const introScreen = document.getElementById('intro-screen');
            const gameScreen = document.getElementById('game-screen');
            const endScreen = document.getElementById('end-screen');
            const resultSection = document.getElementById('result-section');
            const communicationFlow = document.getElementById('communication-flow');
            
            // å¼€å§‹æ¸¸æˆ
            startBtn.addEventListener('click', function() {
                introScreen.classList.add('hidden');
                gameScreen.classList.remove('hidden');
                resultSection.classList.add('hidden');
                initializeCommunicationFlow();
            });
            
            // é‡æ–°å¼€å§‹æ¸¸æˆ
            restartBtn.addEventListener('click', function() {
                endScreen.classList.add('hidden');
                gameScreen.classList.remove('hidden');
                resultSection.classList.add('hidden');
                initializeCommunicationFlow();
            });
            
            // åˆå§‹åŒ–æ²Ÿé€šæµç¨‹å¯è§†åŒ–
            function initializeCommunicationFlow() {
                communicationFlow.innerHTML = '';
                
                const steps = [
                    { icon: 'ğŸ’¡', label: 'ä»»åŠ¡å‘èµ·', color: 'bg-purple-100 text-purple-800' },
                    { icon: 'ğŸ—£ï¸', label: 'ä¼ è¾¾', color: 'bg-blue-100 text-blue-800' },
                    { icon: 'ğŸ‘‚', label: 'æ¥æ”¶', color: 'bg-green-100 text-green-800' },
                    { icon: 'â“', label: 'ç¡®è®¤', color: 'bg-yellow-100 text-yellow-800' },
                    { icon: 'âœ…', label: 'æ‰§è¡Œ', color: 'bg-indigo-100 text-indigo-800' }
                ];
                
                steps.forEach((step, index) => {
                    const stepElement = document.createElement('div');
                    stepElement.className = `flex flex-col items-center`;
                    stepElement.innerHTML = `
                        <div class="message-bubble w-12 h-12 rounded-full flex items-center justify-center mb-1 ${step.color} shadow-md text-xl">
                            ${step.icon}
                        </div>
                        <span class="text-xs text-gray-600">${step.label}</span>
                    `;
                    communicationFlow.appendChild(stepElement);
                    
                    // æ·»åŠ åŠ¨ç”»å»¶è¿Ÿ
                    setTimeout(() => {
                        stepElement.classList.add('fade-in');
                    }, index * 200);
                });
            }
            
            // æ¨¡æ‹Ÿæ‰§è¡Œ
            simulateBtn.addEventListener('click', function() {
                // è·å–æ²Ÿé€šå‚æ•°
                const clarity = parseInt(document.getElementById('clarity').value);
                const timeliness = parseInt(document.getElementById('timeliness').value);
                const feedback = parseInt(document.getElementById('feedback').value);
                
                // æ¨¡æ‹Ÿæ²Ÿé€šè¿‡ç¨‹åŠ¨ç”»
                simulateCommunication(clarity, timeliness, feedback);
                
                // è®¡ç®—æ‰§è¡Œç»“æœ
                setTimeout(() => {
                    showResults(clarity, timeliness, feedback);
                }, 3000);
            });
            
            // æ¨¡æ‹Ÿæ²Ÿé€šè¿‡ç¨‹åŠ¨ç”»
            function simulateCommunication(clarity, timeliness, feedback) {
                const bubbles = document.querySelectorAll('.message-bubble');
                
                // é‡ç½®çŠ¶æ€
                bubbles.forEach(bubble => {
                    bubble.classList.remove('bg-red-100', 'text-red-800', 'bg-green-100', 'text-green-800');
                });
                
                // æ ¹æ®å‚æ•°è´¨é‡å†³å®šåŠ¨ç”»æ•ˆæœ
                const overallQuality = (clarity + timeliness + feedback) / 3;
                
                // æ¨¡æ‹Ÿæ²Ÿé€šè¿‡ç¨‹
                let delay = 0;
                bubbles.forEach((bubble, index) => {
                    setTimeout(() => {
                        // æ·»åŠ è„‰å†²åŠ¨ç”»
                        bubble.classList.add('transform', 'scale-110');
                        
                        // æ ¹æ®å‚æ•°å†³å®šæ²Ÿé€šæ˜¯å¦æˆåŠŸ
                        const successProbability = overallQuality / 100 * 0.8 + 0.2; // ç¡®ä¿è‡³å°‘æœ‰20%æˆåŠŸæ¦‚ç‡
                        const isSuccess = Math.random() < successProbability;
                        
                        if (isSuccess) {
                            bubble.classList.add('bg-green-100', 'text-green-800');
                        } else {
                            bubble.classList.add('bg-red-100', 'text-red-800');
                        }
                        
                        setTimeout(() => {
                            bubble.classList.remove('transform', 'scale-110');
                        }, 500);
                        
                        // å¦‚æœæ˜¯æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ˜¾ç¤ºç»“æœ
                        if (index === bubbles.length - 1) {
                            setTimeout(() => {
                                resultSection.classList.remove('hidden');
                                resultSection.classList.add('fade-in');
                                // æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
                                resultSection.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                            }, 500);
                        }
                    }, delay);
                    
                    delay += 500 + (100 - timeliness) * 2; // åŠæ—¶æ€§å½±å“æ²Ÿé€šé€Ÿåº¦
                });
            }
            
            // æ˜¾ç¤ºæ‰§è¡Œç»“æœ
            function showResults(clarity, timeliness, feedback) {
                // è®¡ç®—æ‰§è¡Œæ•ˆç‡ (åŠ æƒå¹³å‡)
                const efficiency = clarity * 0.4 + timeliness * 0.3 + feedback * 0.3;
                
                // è®¡ç®—ä»»åŠ¡å®Œæˆåº¦ (å—æœ€ä½å‚æ•°å½±å“)
                const minParam = Math.min(clarity, timeliness, feedback);
                const completion = minParam * 0.7 + (clarity + timeliness + feedback) / 3 * 0.3;
                
                // æ›´æ–°è¿›åº¦æ¡
                document.getElementById('efficiency-bar').style.width = `${efficiency}%`;
                document.getElementById('completion-bar').style.width = `${completion}%`;
                
                // æ›´æ–°åˆ†æ•°æ˜¾ç¤º
                document.getElementById('efficiency-score').textContent = `${Math.round(efficiency)}%`;
                document.getElementById('completion-score').textContent = `${Math.round(completion)}%`;
                
                // æä¾›åé¦ˆå»ºè®®
                const feedbackElement = document.getElementById('result-feedback');
                
                if (efficiency >= 80) {
                    feedbackElement.textContent = "ä¼˜ç§€! æ‚¨çš„æ²Ÿé€šæ–¹å¼éå¸¸é«˜æ•ˆï¼Œæ‰§è¡Œæ•ˆæœæä½³ã€‚";
                    feedbackElement.className = "italic text-green-600";
                } else if (efficiency >= 60) {
                    feedbackElement.textContent = "è‰¯å¥½! æ²Ÿé€šæ•ˆæœä¸é”™ï¼Œä½†ä»æœ‰æå‡ç©ºé—´ã€‚";
                    feedbackElement.className = "italic text-blue-600";
                } else if (efficiency >= 40) {
                    feedbackElement.textContent = "ä¸€èˆ¬ã€‚å»ºè®®æé«˜æ²Ÿé€šæ¸…æ™°åº¦æˆ–åé¦ˆé¢‘ç‡ã€‚";
                    feedbackElement.className = "italic text-yellow-600";
                } else {
                    feedbackElement.textContent = "éœ€è¦æ”¹è¿›ã€‚æ²Ÿé€šæ•ˆæœä¸ä½³å¯¼è‡´æ‰§è¡Œæ•ˆç‡ä½ä¸‹ã€‚";
feedbackElement.className = "italic text-red-600";
                }
              
                // å¦‚æœç”¨æˆ·å°è¯•äº†å¤šç§ç»„åˆï¼Œæ˜¾ç¤ºç»“æŸç•Œé¢
                if (simulateBtn.getAttribute('data-runs') >= 3) {
                    setTimeout(() => {
                        gameScreen.classList.add('hidden');
                        endScreen.classList.remove('hidden');
                        endScreen.classList.add('fade-in');
                        endScreen.scrollIntoView({ behavior: 'smooth' });
                    }, 2000);
                } else {
                    // å¢åŠ è¿è¡Œè®¡æ•°
                    const runs = parseInt(simulateBtn.getAttribute('data-runs') || '0');
                    simulateBtn.setAttribute('data-runs', runs + 1);
                }
            }

            // å®æ—¶æ›´æ–°æ»‘å—å€¼æ˜¾ç¤º
            document.getElementById('clarity').addEventListener('input', function() {
                document.getElementById('clarity-value').textContent = this.value + '%';
            });
            document.getElementById('timeliness').addEventListener('input', function() {
                document.getElementById('timeliness-value').textContent = this.value + '%';
            });
            document.getElementById('feedback').addEventListener('input', function() {
                document.getElementById('feedback-value').textContent = this.value + '%';
            });

            // ä¸ºæ¨¡æ‹ŸæŒ‰é’®æ·»åŠ è¿è¡Œè®¡æ•°å±æ€§
            simulateBtn.setAttribute('data-runs', '0');
        });
    </script>
</body>
</html>

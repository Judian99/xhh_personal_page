<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>顾客锁定算法 - 可视化技术方案</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Framer Motion CDN -->
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <!-- Font Awesome CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap');
        body {
            font-family: 'Noto Sans SC', sans-serif;
            background-color: #f8fafc;
        }
        .highlight-red {
            background: linear-gradient(90deg, rgba(227,25,55,0.1) 0%, rgba(227,25,55,0.3) 100%);
        }
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        .line-art {
            stroke-width: 2;
            stroke-linecap: round;
            stroke-linejoin: round;
            fill: none;
        }
    </style>
</head>
<body class="min-h-screen bg-gray-50">
    <div class="container mx-auto px-4 py-12">
        <!-- 标题部分 -->
        <div class="text-center mb-16">
            <h1 class="text-4xl md:text-5xl font-bold text-gray-900 mb-4">顾客支付锁定与房间状态判定算法</h1>
            <p class="text-xl text-gray-600 max-w-3xl mx-auto">可视化技术方案功能模块参考</p>
        </div>

        <!-- Bento Grid 布局 -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-12">
            <!-- 设备管理模块 -->
            <div class="bg-white rounded-xl shadow-md p-6 col-span-1 md:col-span-2 lg:col-span-1 transition-all duration-300 card-hover"
                data-motion="fadeIn">
                <div class="flex items-center mb-4">
                    <div class="w-12 h-12 rounded-full bg-blue-100 flex items-center justify-center mr-4">
                        <i class="fas fa-server text-blue-500 text-xl"></i>
                    </div>
                    <h2 class="text-2xl font-bold text-gray-800">设备管理模块</h2>
                </div>
                <ul class="space-y-3">
                    <li class="flex items-start">
                        <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                        <span class="text-gray-700">同步设备状态</span>
                    </li>
                    <li class="flex items-start">
                        <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                        <span class="text-gray-700">按区域分类</span>
                    </li>
                </ul>
                <div class="mt-6">
                    <svg width="100%" height="120" viewBox="0 0 300 120" class="line-art">
                        <path d="M20,60 Q50,30 80,60 T140,60 T200,60 T260,60" stroke="#3b82f6" opacity="0.8"/>
                        <circle cx="20" cy="60" r="5" fill="#3b82f6"/>
                        <circle cx="80" cy="60" r="5" fill="#3b82f6"/>
                        <circle cx="140" cy="60" r="5" fill="#3b82f6"/>
                        <circle cx="200" cy="60" r="5" fill="#3b82f6"/>
                        <circle cx="260" cy="60" r="5" fill="#3b82f6"/>
                        <text x="20" y="90" font-size="10" text-anchor="middle" fill="#6b7280">设备1</text>
                        <text x="80" y="90" font-size="10" text-anchor="middle" fill="#6b7280">设备2</text>
                        <text x="140" y="90" font-size="10" text-anchor="middle" fill="#6b7280">设备3</text>
                        <text x="200" y="90" font-size="10" text-anchor="middle" fill="#6b7280">设备4</text>
                        <text x="260" y="90" font-size="10" text-anchor="middle" fill="#6b7280">设备5</text>
                    </svg>
                </div>
            </div>

            <!-- 操作间在忙状态判断模块 -->
            <div class="bg-white rounded-xl shadow-md p-6 transition-all duration-300 card-hover"
                data-motion="fadeIn">
                <div class="flex items-center mb-4">
                    <div class="w-12 h-12 rounded-full bg-purple-100 flex items-center justify-center mr-4">
                        <i class="fas fa-eye text-purple-500 text-xl"></i>
                    </div>
                    <h2 class="text-2xl font-bold text-gray-800">在忙状态判断</h2>
                </div>
                <div class="mb-4">
                    <h3 class="text-lg font-semibold text-gray-700 mb-2">工作时间段抽帧 (10:00-19:00)</h3>
                    <div class="flex space-x-4 mb-3">
                        <div class="flex-1 bg-gray-100 rounded-lg p-3">
                            <p class="text-sm text-gray-600">本地录像抽帧</p>
                            <div class="flex justify-between mt-1">
                                <span class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded">间隔30分钟 (19张)</span>
                                <span class="text-xs bg-green-100 text-green-800 px-2 py-1 rounded">间隔15分钟 (37张)</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div>
                    <h3 class="text-lg font-semibold text-gray-700 mb-2">状态判断逻辑</h3>
                    <div class="space-y-3">
                        <div class="bg-gray-50 p-3 rounded-lg">
                            <p class="text-sm font-medium text-gray-700">视觉模型分析 (qwen-vl-max)</p>
                            <p class="text-xs text-gray-500 mt-1">房间状态判定提示词</p>
                        </div>
                        <div class="bg-gray-50 p-3 rounded-lg">
                            <p class="text-sm font-medium text-gray-700">图片相似度对比 (ResNet50模型)</p>
                            <p class="text-xs text-gray-500 mt-1">相似度阈值: 0.942</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 顾客支付节点判断模块 -->
            <div class="bg-white rounded-xl shadow-md p-6 transition-all duration-300 card-hover"
                data-motion="fadeIn">
                <div class="flex items-center mb-4">
                    <div class="w-12 h-12 rounded-full bg-green-100 flex items-center justify-center mr-4">
                        <i class="fas fa-money-bill-wave text-green-500 text-xl"></i>
                    </div>
                    <h2 class="text-2xl font-bold text-gray-800">支付节点判断</h2>
                </div>
                <div class="space-y-4">
                    <div>
                        <h3 class="text-lg font-semibold text-gray-700 mb-2">支付行为识别流程</h3>
                        <ol class="list-decimal list-inside space-y-2 text-sm text-gray-700">
                            <li>获取支付时间点</li>
                            <li>对所有操作间抽帧 (支付时间点、前一秒、前两秒)</li>
                            <li>支付行为视觉判定 (批处理)</li>
                        </ol>
                    </div>
                    <div class="bg-yellow-50 border-l-4 border-yellow-400 p-3 rounded-r">
                        <p class="text-sm text-yellow-700">判定提示词: 房间内存在至少两人且正在进行手机扫码支付交易行为</p>
                    </div>
                </div>
            </div>

            <!-- 计划任务模块 -->
            <div class="bg-white rounded-xl shadow-md p-6 transition-all duration-300 card-hover"
                data-motion="fadeIn">
                <div class="flex items-center mb-4">
                    <div class="w-12 h-12 rounded-full bg-indigo-100 flex items-center justify-center mr-4">
                        <i class="fas fa-tasks text-indigo-500 text-xl"></i>
                    </div>
                    <h2 class="text-2xl font-bold text-gray-800">计划任务模块</h2>
                </div>
                <div class="space-y-4">
                    <div class="flex items-start">
                        <div class="flex-shrink-0 mt-1">
                            <i class="fas fa-play-circle text-blue-500 mr-2"></i>
                        </div>
                        <div>
                            <h4 class="font-medium text-gray-800">在线查看回放</h4>
                            <ol class="list-decimal list-inside text-sm text-gray-600 ml-4">
                                <li>选取时间段</li>
                                <li>获取在线播放链接</li>
                            </ol>
                        </div>
                    </div>
                    <div class="flex items-start">
                        <div class="flex-shrink-0 mt-1">
                            <i class="fas fa-download text-green-500 mr-2"></i>
                        </div>
                        <div>
                            <h4 class="font-medium text-gray-800">回放录制下载 (云录制1.0)</h4>
                            <ol class="list-decimal list-inside text-sm text-gray-600 ml-4">
                                <li>选取时间段</li>
                                <li>建立下载任务 (2倍速)</li>
                                <li>返回下载地址</li>
                            </ol>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 视图模块 -->
            <div class="bg-white rounded-xl shadow-md p-6 col-span-1 md:col-span-2 transition-all duration-300 card-hover"
                data-motion="fadeIn">
                <div class="flex items-center mb-4">
                    <div class="w-12 h-12 rounded-full bg-red-100 flex items-center justify-center mr-4">
                        <i class="fas fa-table text-red-500 text-xl"></i>
                    </div>
                    <h2 class="text-2xl font-bold text-gray-800">视图模块</h2>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <h3 class="font-semibold text-gray-800 mb-2 flex items-center">
                            <i class="fas fa-calendar-alt text-blue-500 mr-2"></i>
                            排客表视图
                        </h3>
                        <p class="text-sm text-gray-600">以排客表的形式显示各个操作间的在忙状态</p>
                        <div class="mt-3 flex justify-center">
                            <svg width="100%" height="100" viewBox="0 0 300 100" class="line-art">
                                <rect x="10" y="20" width="80" height="60" rx="5" stroke="#3b82f6" fill="rgba(59, 130, 246, 0.1)"/>
                                <rect x="110" y="20" width="80" height="60" rx="5" stroke="#10b981" fill="rgba(16, 185, 129, 0.1)"/>
                                <rect x="210" y="20" width="80" height="60" rx="5" stroke="#ef4444" fill="rgba(239, 68, 68, 0.1)"/>
                                <text x="50" y="60" font-size="12" text-anchor="middle" fill="#1f2937">空闲</text>
                                <text x="150" y="60" font-size="12" text-anchor="middle" fill="#1f2937">服务中</text>
                            </svg>
                        </div>
                    </div>
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <h3 class="font-semibold text-gray-800 mb-2 flex items-center">
                            <i class="fas fa-images text-purple-500 mr-2"></i>
                            画廊视图
                        </h3>
                        <p class="text-sm text-gray-600">按当天支付顾客或按房间显示抽帧图</p>
                        <div class="mt-3 flex justify-center">
                            <svg width="100%" height="100" viewBox="0 0 300 100" class="line-art">
                                <rect x="20" y="30" width="60" height="40" stroke="#8b5cf6" fill="rgba(139, 92, 246, 0.1)"/>
                                <rect x="90" y="20" width="60" height="50" stroke="#8b5cf6" fill="rgba(139, 92, 246, 0.1)"/>
                                <rect x="160" y="25" width="60" height="45" stroke="#8b5cf6" fill="rgba(139, 92, 246, 0.1)"/>
                                <rect x="230" y="35" width="60" height="35" stroke="#8b5cf6" fill="rgba(139, 92, 246, 0.1)"/>
                                <line x1="40" y1="70" x2="40" y2="85" stroke="#8b5cf6"/>
                                <line x1="120" y1="70" x2="120" y2="85" stroke="#8b5cf6"/>
                                <line x1="190" y1="70" x2="190" y2="85" stroke="#8b5cf6"/>
                                <line x1="260" y1="70" x2="260" y2="85" stroke="#8b5cf6"/>
                            </svg>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 测试数据模块 -->
            <div class="bg-white rounded-xl shadow-md p-6 col-span-1 md:col-span-2 lg:col-span-1 transition-all duration-300 card-hover highlight-red"
                data-motion="fadeIn">
                <div class="flex items-center mb-4">
                    <div class="w-12 h-12 rounded-full bg-orange-100 flex items-center justify-center mr-4">
                        <i class="fas fa-flask text-orange-500 text-xl"></i>
                    </div>
                    <h2 class="text-2xl font-bold text-gray-800">仓山店测试数据</h2>
                </div>
                <div class="space-y-4">
                    <div class="bg-white p-4 rounded-lg border border-gray-200">
                        <a href="https://flowus.cn/share/d9b50f73-4917-41c8-be92-23d1dbea1090?code=RJCBXF" target="_blank" class="flex items-center text-blue-600 hover:text-blue-800">
                            <i class="fas fa-file-alt mr-2"></i>
                            <span>图像序列相似度技术报告</span>
                            <i class="fas fa-external-link-alt ml-2 text-xs"></i>
                        </a>
                    </div>
                    <div class="bg-white p-4 rounded-lg border border-gray-200">
                        <a href="https://flowus.cn/share/706f31b5-8921-4fed-a185-93a98d562b32?code=RJCBXF" target="_blank" class="flex items-center text-blue-600 hover:text-blue-800">
                            <i class="fas fa-file-alt mr-2"></i>
                            <span>支付行为视觉判定测试</span>
                            <i class="fas fa-external-link-alt ml-2 text-xs"></i>
                        </a>
                    </div>
                </div>
                <div class="mt-6">
                    <svg width="100%" height="80" viewBox="0 0 300 80" class="line-art">
                        <path d="M20,40 Q80,10 140,40 Q200,70 260,40" stroke="#e31937" opacity="0.7"/>
                        <circle cx="20" cy="40" r="4" fill="#e31937"/>
                        <circle cx="80" cy="10" r="4" fill="#e31937"/>
                        <circle cx="140" cy="40" r="4" fill="#e31937"/>
                        <circle cx="200" cy="70" r="4" fill="#e31937"/>
                        <circle cx="260" cy="40" r="4" fill="#e31937"/>
                        <text x="20" y="70" font-size="10" text-anchor="middle" fill="#6b7280">测试1</text>
<text x="80" y="25" font-size="10" text-anchor="middle" fill="#6b7280">测试2</text>
                        <text x="140" y="70" font-size="10" text-anchor="middle" fill="#6b7280">测试3</text>
                        <text x="200" y="25" font-size="10" text-anchor="middle" fill="#6b7280">测试4</text>
                        <text x="260" y="70" font-size="10" text-anchor="middle" fill="#6b7280">测试5</text>
                    </svg>
                </div>
            </div>
        </div>

        <!-- 注意事项部分 -->
        <div class="bg-white rounded-xl shadow-md p-6 mb-12 transition-all duration-300 card-hover"
            data-motion="fadeIn">
            <div class="flex items-center mb-4">
                <div class="w-12 h-12 rounded-full bg-yellow-100 flex items-center justify-center mr-4">
                    <i class="fas fa-exclamation-triangle text-yellow-500 text-xl"></i>
                </div>
                <h2 class="text-2xl font-bold text-gray-800">注意事项</h2>
            </div>
            <div class="space-y-4">
                <div>
                    <h3 class="text-lg font-semibold text-gray-700 mb-2">抽帧接口选择</h3>
                    <div class="flex flex-col sm:flex-row gap-4">
                        <div class="flex-1 bg-gray-100 rounded-lg p-3">
                            <p class="text-sm font-medium text-gray-700 flex items-center">
                                <i class="fas fa-clock text-blue-500 mr-2"></i>
                                时间间隔视频抽帧接口
                            </p>
                            <p class="text-xs text-red-500 mt-1">(不推荐，任务会卡进度)</p>
                        </div>
                        <div class="flex-1 bg-gray-100 rounded-lg p-3">
                            <p class="text-sm font-medium text-gray-700 flex items-center">
                                <i class="fas fa-check-circle text-green-500 mr-2"></i>
                                <a href="https://open.ys7.com/help/1389" target="_blank" class="hover:underline">
                                    时间点视频抽帧接口
                                </a>
                            </p>
                            <p class="text-xs text-green-600 mt-1">(建议用此接口抽帧)</p>
                        </div>
                    </div>
                </div>
                <div class="bg-blue-50 border-l-4 border-blue-400 p-3 rounded-r">
                    <p class="text-sm text-blue-700">
                        工作时间段抽帧对应门店所有的房间，但是两个主要判断模块目前只针对操作间判断即可，排客表视图也只显示操作间
                    </p>
                </div>
            </div>
        </div>

        <!-- 技术细节展示 -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-12">
            <!-- 状态判断提示词 -->
            <div class="bg-white rounded-xl shadow-md p-6 transition-all duration-300 card-hover"
                data-motion="fadeIn">
                <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                    <i class="fas fa-comment-alt text-purple-500 mr-2"></i>
                    房间状态判定提示词
                </h3>
                <div class="bg-gray-800 rounded-lg p-4 overflow-x-auto">
                    <pre class="text-sm text-green-400 font-mono">
<span class="text-gray-400"># 房间状态判定提示词</span>
你需要对这张图片做出判断：
1. 当前房间内是否有人？
2. 美容床上是否有顾客？
你最终只需要输出唯一结果：'True'or'False'\n不要任何解释。</pre>
                </div>
            </div>

            <!-- 相似度计算代码 -->
            <div class="bg-white rounded-xl shadow-md p-6 transition-all duration-300 card-hover"
                data-motion="fadeIn">
                <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                    <i class="fas fa-code text-blue-500 mr-2"></i>
                    图片相似度计算代码
                </h3>
                <div class="bg-gray-800 rounded-lg p-4 overflow-x-auto">
                    <pre class="text-sm text-green-400 font-mono">
<span class="text-gray-400"># Python代码示例</span>
import cv2
import numpy as np
import pandas as pd
from sklearn.metrics.pairwise import cosine_similarity
from tensorflow.keras.applications.resnet50 import ResNet50, preprocess_input
from tensorflow.keras.preprocessing import image
from tensorflow.keras.models import Model

<span class="text-gray-400"># 加载图像帧</span>
frames = [cv2.imread(f'7hao/{i}.jpg') for i in range(1, 21)]

<span class="text-gray-400"># 使用ResNet50模型提取特征</span>
base_model = ResNet50(weights='imagenet')
model = Model(inputs=base_model.input, outputs=base_model.get_layer('avg_pool').output)

<span class="text-gray-400"># 计算相似度</span>
features = [extract_features(frame) for frame in resized_frames]
similarities = [cosine_similarity([features[i]], [features[i+1]])[0][0] 
               for i in range(len(features)-1)]

<span class="text-gray-400"># 设定相似度阈值</span>
threshold = 0.942</pre>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 滚动动画效果
        document.addEventListener('DOMContentLoaded', function() {
            const motionElements = document.querySelectorAll('[data-motion="fadeIn"]');
          
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.opacity = 1;
                        entry.target.style.transform = 'translateY(0)';
                        observer.unobserve(entry.target);
                    }
                });
            }, { threshold: 0.1 });

            motionElements.forEach(element => {
                element.style.opacity = 0;
                element.style.transform = 'translateY(20px)';
                element.style.transition = 'opacity 0.6s ease-out, transform 0.6s ease-out';
                observer.observe(element);
            });

            // 卡片悬停效果增强
            const cards = document.querySelectorAll('.card-hover');
            cards.forEach(card => {
                card.addEventListener('mouseenter', () => {
                    card.style.transition = 'all 0.3s ease';
                });
                card.addEventListener('mouseleave', () => {
                    card.style.transition = 'all 0.3s ease';
                });
            });
        });
    </script>
</body>
</html>
